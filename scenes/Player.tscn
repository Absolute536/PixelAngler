[gd_scene load_steps=14 format=3 uid="uid://bd2sgwdtpfwaj"]

[ext_resource type="SpriteFrames" uid="uid://chi3wqli78166" path="res://resources/Player.tres" id="1_p0vlq"]
[ext_resource type="Script" uid="uid://dwkgu7hv8ofdd" path="res://scripts/player/Player.cs" id="1_v6fml"]
[ext_resource type="AudioStream" uid="uid://df2su45hulwfh" path="res://assets/audio/sound_effects/KeySound2.mp3" id="3_cw2d6"]
[ext_resource type="Script" uid="uid://bakg405h3gvhu" path="res://scripts/states/StateMachine.cs" id="3_mdl7e"]
[ext_resource type="Script" uid="uid://c3nbul0aiq2h4" path="res://scripts/states/PlayerIdleState.cs" id="4_qu4a1"]
[ext_resource type="Script" uid="uid://bt2i3d64duevn" path="res://scripts/states/PlayerWalkingState.cs" id="5_qu4a1"]
[ext_resource type="Script" uid="uid://b5c6xmf5euuwj" path="res://scripts/states/PlayerFishingState.cs" id="8_d2wvv"]
[ext_resource type="PackedScene" uid="uid://cwtba6wd0gfht" path="res://scenes/cast_marker.tscn" id="8_smehm"]
[ext_resource type="Script" uid="uid://bug1toj6bvtq3" path="res://scripts/states/PlayerCastingState.cs" id="8_y4r1p"]
[ext_resource type="PackedScene" uid="uid://1w1wporxjcab" path="res://scenes/bobber.tscn" id="9_ur7pv"]
[ext_resource type="PackedScene" uid="uid://d1r8eckfg8xw" path="res://scenes/fishing_line.tscn" id="11_d2wvv"]
[ext_resource type="Script" uid="uid://dp3ijpwnmjedy" path="res://scripts/game_mechanism/FishingQuickTimeEvent.cs" id="12_3v2ag"]

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_p0vlq"]
radius = 5.0
height = 26.0

[node name="Player" type="CharacterBody2D" node_paths=PackedStringArray("AnimationPlayer", "AudioPlayer", "DebugText") groups=["Player"]]
motion_mode = 1
script = ExtResource("1_v6fml")
AnimationPlayer = NodePath("PlayerAnimation")
AudioPlayer = NodePath("AudioStreamPlayer2D")
DebugText = NodePath("DebugText")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
y_sort_enabled = true
position = Vector2(0, -12)
shape = SubResource("CapsuleShape2D_p0vlq")

[node name="PlayerAnimation" type="AnimatedSprite2D" parent="."]
sprite_frames = ExtResource("1_p0vlq")
animation = &"Down"
offset = Vector2(0, -16)

[node name="DebugText" type="Label" parent="."]
offset_left = -41.0
offset_top = -46.0
offset_right = 47.0
offset_bottom = -5.0

[node name="Camera2D" type="Camera2D" parent="."]
process_callback = 0

[node name="AudioStreamPlayer2D" type="AudioStreamPlayer2D" parent="."]
stream = ExtResource("3_cw2d6")
volume_db = -6.0

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("initialState")]
script = ExtResource("3_mdl7e")
initialState = NodePath("PlayerIdleState")
metadata/_custom_type_script = "uid://bakg405h3gvhu"

[node name="PlayerIdleState" type="Node" parent="StateMachine" node_paths=PackedStringArray("Player")]
script = ExtResource("4_qu4a1")
Player = NodePath("../..")
metadata/_custom_type_script = "uid://c3nbul0aiq2h4"

[node name="PlayerWalkingState" type="Node" parent="StateMachine" node_paths=PackedStringArray("Player")]
script = ExtResource("5_qu4a1")
Player = NodePath("../..")
MovementSpeed = 100.0
metadata/_custom_type_script = "uid://bt2i3d64duevn"

[node name="PlayerCastingState" type="Node" parent="StateMachine" node_paths=PackedStringArray("Player", "CastMarker", "Bobber", "FishingLine")]
script = ExtResource("8_y4r1p")
Player = NodePath("../..")
CastMarker = NodePath("../../ActionUI/CastMarker")
Bobber = NodePath("../../ActionUI/Bobber")
FishingLine = NodePath("../../ActionUI/FishingLine")
metadata/_custom_type_script = "uid://bug1toj6bvtq3"

[node name="PlayerFishingState" type="Node" parent="StateMachine" node_paths=PackedStringArray("Bobber", "FishingQTE")]
script = ExtResource("8_d2wvv")
Bobber = NodePath("../../ActionUI/Bobber")
FishingQTE = NodePath("../../Miscellaneous/FishingQuickTimeEvent")
metadata/_custom_type_script = "uid://b5c6xmf5euuwj"

[node name="ActionUI" type="Node2D" parent="."]

[node name="CastMarker" parent="ActionUI" node_paths=PackedStringArray("TargetPlayer", "Bobber", "FishingLine") instance=ExtResource("8_smehm")]
visible = false
TargetPlayer = NodePath("../..")
Bobber = NodePath("../Bobber")
FishingLine = NodePath("../FishingLine")

[node name="FishingLine" parent="ActionUI" node_paths=PackedStringArray("Player", "TraceTarget") instance=ExtResource("11_d2wvv")]
visible = false
width = 1.0
Player = NodePath("../..")
TraceTarget = NodePath("../Bobber")

[node name="Bobber" parent="ActionUI" node_paths=PackedStringArray("Player", "FishingLine") instance=ExtResource("9_ur7pv")]
visible = false
Player = NodePath("../..")
FishingLine = NodePath("../FishingLine")
SetLaunchAngle = 45.0

[node name="Miscellaneous" type="Node" parent="."]

[node name="FishingQuickTimeEvent" type="Node" parent="Miscellaneous"]
script = ExtResource("12_3v2ag")
Duration = 0.7
metadata/_custom_type_script = "uid://dp3ijpwnmjedy"
